{% extends 'base.html' %}
{% load static %}
{% block title %}
<title>Main-Page</title>
{% endblock %}
{% block style %}
<link rel="stylesheet" href="{% static "pizzaplace/main.css" %}">
{% endblock %}

{% block content %}


<h1 class = "menu">Main Menu</h1>

    <div class="all-menu">
    <h1 class="label">Pizza</h1>
        <div class="menu-main">

    {% for pizza in pizzas %}
        {% include "pizzaplace/include/pizza_card.html" %}
    {% endfor %}

    </div>
    <h1 class="label">Appetizer</h1>
    <div class="menu-main">
     {% for appetizer in appetizers %}
        {% include "pizzaplace/include/appetizer.html" %}
    {% endfor %}
    </div>
    <h1 class="label" >Salads</h1>
    <div class="menu-main">
     {% for salad in salads %}
        {% include "pizzaplace/include/salad.html" %}
    {% endfor %}
    </div>
     <h1 class="label">Drinks</h1>
    <div class="menu-main">
     {% for drink in drinks %}
        {% include "pizzaplace/include/drink.html" %}
    {% endfor %}
    </div>

    </div>

    <dialog id="login-dialog">
    <div class="wrapper" >
        <form method="dialog">
        <button id="cancelButton">Cancel</button>
        <h2 class="item-name">Purchase Item</h2>
        <p class="item-price">price</p>
        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" name="quantity" min="1" value="1" required>
        <button id="addToCartButton">Add to Cart</button>
        <button id="buyNowButton">Buy Now</button>
            </form>
    </div>
    </dialog>
    <footer></footer>
{% endblock %}

{% block script %}
    <script>
    document.addEventListener('DOMContentLoaded', (event) =>{
        const login = document.getElementById("login-dialog")
        const name = document.querySelector(".item-name")
        const price = document.querySelector(".item-price")
        const quantity = document.querySelector("#quantity")
        const wrapper = document.querySelector(".wrapper")

        let itemprice = 0;


        document.querySelectorAll(".purchase-link").forEach(link =>{
            link.addEventListener("click", (event) =>{
                event.preventDefault()
            let itemname = event.target.dataset.name;
            itemprice = parseFloat(event.target.dataset.price) ;
            name.textContent = itemname;
            quantity.value = 1;
            Updateprice()
            login.showModal();
            })
        })


        const Updateprice= () =>{
            let updatedPrice =  itemprice * quantity.value;
            price.innerHTML = `<b>Price:</b> $${updatedPrice.toFixed(2)}`;
        }

          quantity.addEventListener('input', Updateprice);

        login.addEventListener("click", (e) => !wrapper.contains(e.target) && login.close() )

        document.querySelector("#cancelButton").addEventListener("click", () => {
            login.close()
        })
    })
    </script>
{% endblock %}